<!DOCTYPE html>
<html>
<head>
  <title>Login with Google</title>
</head>
<body>
  <h2>AI Resume Screening System - Login</h2>
  <button onclick="googleLogin()">Sign in with Google</button>

  <!-- Firebase JS SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>

  <script>
    const firebaseConfig = {
        apiKey: "AIzaSyBYVdr15uRbHp8Z7BNKmh5g3fwSMRFtC0E",
        authDomain: "nithish-32bc8.firebaseapp.com",
        projectId: "nithish-32bc8",
        storageBucket: "nithish-32bc8.firebasestorage.app",
        messagingSenderId: "193597687371",
        appId: "1:193597687371:web:c53a73bc5ba2af8f1fafce"
    };
    firebase.initializeApp(firebaseConfig);

    function googleLogin() {
      const provider = new firebase.auth.GoogleAuthProvider();
      firebase.auth().signInWithPopup(provider)
        .then(result => {
          return result.user.getIdToken();
        })
        .then(idToken => {
          return fetch('/verify-token', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({ token: idToken })
          });
        })
        .then(response => response.json())
        .then(data => {
          if (data.success) {
            window.location.href = '/upload'; // Redirect after success
          } else {
            alert("Login failed");
          }
        })
        .catch(error => {
          console.error("Login Error:", error);
          alert("Authentication failed: " + error.message);
        });
    }
  </script>
</body>
</html>
